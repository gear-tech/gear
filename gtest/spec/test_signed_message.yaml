title: Signed message (well known cases)

programs:
  - id: 1
    path: target/wasm32-unknown-unknown/release/demo_signed_message.wasm
    init_message:
      # bob
      kind: bytes
      value: "8eaf04151687736326c9fea17e25fc5287613693c912909cb226aa4794f26a48"

fixtures:
  - title: PING from Bob

    messages:
      - destination: 1
        payload:
          kind: custom
          value:
            message: "PING"
            signature: "0xea2602a9883dc2c6b653c1a616cefec77783d1cbb9a3b59e765f8ab2d640813788318a1659638410a731b8b0f172c366327d1125c564a681de82d2282695a588"

    expected:
      - step: 1
        log:
          - destination: 0
            payload:
              kind: utf-8
              value: Reply to signed message

  - title: PING2 from Bob

    messages:
      - destination: 1
        payload:
          kind: custom
          value:
            message: "PING"
            signature: "0xfa2602a9883dc2c6b653c1a616cefec77783d1cbb9a3b59e765f8ab2d640813788318a1659638410a731b8b0f172c366327d1125c564a681de82d2282695a588"

    expected:
      - step: 1
        log:
          - destination: 0
            payload:
              kind: utf-8
              value: Incorrect signature

  - title: PING from Alice

    messages:
      - destination: 1
        payload:
          kind: custom
          value:
            message: "PING"
            signature: "0x5653dffa5d5d34be4cafd21f27ee05a291a119ec0b775d78e8414baf42bcbf5d784b2194e63fa146f4a42f021ca9178fb0f13ecebdef7841084644bb48bb0688"

    expected:
      - step: 1
        log:
          - destination: 0
            payload:
              kind: utf-8
              value: Incorrect signature

  - title: PING from Bob but with '--scheme Ecdsa'

    messages:
      - destination: 1
        payload:
          kind: custom
          value:
            message: "PING"
            signature: "0xe7f984e6453258bb26425b37448b3130c9ece70e18f1744cbef92dbb7e8df82c645822aca46c943c5660824b85956675c4914a858853b37857f04431154ccbe400"

    expected:
      - step: 1
        log:
          - destination: 0
            payload:
              kind: utf-8
              value: Wrong signature length
