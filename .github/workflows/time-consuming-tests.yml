name: Time consuming tests

on:
  workflow_dispatch:

env:
  CARGO_TERM_COLOR: always
  TERM: xterm-256color

jobs:
  comparison-table:
    runs-on: [kuberunner]
    env:
      RUSTUP_HOME: /tmp/rustup_home
    steps:
      - name: "ACTIONS: Checkout & fetch all history"
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: "Install: Set cargo path"
        run: echo "/tmp/cargo/bin" >> $GITHUB_PATH

      - name: "Install: Rust toolchain"
        uses: dsherret/rust-toolchain-file@v1

      - name: "Build: Init"
        run: ./scripts/gear.sh init cargo

      - name: "Generate comparison tables"
        run: |
          ./scripts/weight-diff.sh master $(git branch --show-current) gear --display-units
