name: Label

on:
  pull_request:
    branches: [master]
    # types: [labeled]

jobs:
  linux:
    runs-on: ubuntu-latest
    # if: >-
    #   github.event.label.name == 'A0-pleasereview'
    #   || github.event.label.name == 'A4-insubstantial'
    #   || github.event.label.name == 'A2-mergeoncegreen'

    steps:
      - uses: actions/checkout@v4
      - name: Fork Linux checks
        uses: gear-tech/fork-action@cl/required-checks
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          head_sha: ${{ github.event.pull_request.head.sha }}
          ref: ${{ github.head_ref || github.ref_name }}
          repo: "gear-tech/gear"
          workflow_id: ".github/workflows/build.yml"
          prefix: "build"
          needs: '["dynamic-profiles"]'
          jobs: '["linux (debug)", "win-cross (debug)"]'
          inputs:
            '{ "title": "${{ github.event.pull_request.title }}", "number": "${{
            github.event.number }}" }'

  osx:
    runs-on: ubuntu-latest
    # if: github.event.label.name == 'E2-forcemacos'
    steps:
      - uses: actions/checkout@v4
      - name: Fork OSX checks
        uses: gear-tech/fork-action@cl/required-checks
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          head_sha: ${{ github.event.pull_request.head.sha }}
          ref: ${{ github.head_ref || github.ref_name }}
          repo: "gear-tech/gear"
          workflow_id: ".github/workflows/build-macos.yml"
          prefix: "build"
          needs: '["dynamic-profiles"]'
          jobs: '["macos-x86 (debug)", "macos-aarch64 (debug)"]'
