<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Creates program initialization request (message), that is scheduled to be run in the same block."><title>upload_program in pallet_gear::pallet::dispatchables - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-84e720fa.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="pallet_gear" data-themes="" data-resource-suffix="" data-rustdoc-version="1.89.0-nightly (ccf3198de 2025-06-05)" data-channel="nightly" data-search-js="search-f7877310.js" data-settings-js="settings-5514c975.js" ><script src="../../../static.files/storage-4e99c027.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-fd3af306.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-32bb7600.css"></noscript><link rel="icon" href="https://gear-tech.io/favicons/favicon.ico"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../../pallet_gear/index.html"><img src="https://docs.gear.rs/logo.svg" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../../pallet_gear/index.html"><img src="https://docs.gear.rs/logo.svg" alt="logo"></a><h2><a href="../../../pallet_gear/index.html">pallet_<wbr>gear</a><span class="version">1.9.1</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">upload_<wbr>program</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#note" title="Note">Note</a></li><li><a href="#warning-doc-only" title="Warning: Doc-Only">Warning: Doc-Only</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="index.html">In pallet_<wbr>gear::<wbr>pallet::<wbr>dispatchables</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">pallet_gear</a>::<wbr><a href="../index.html">pallet</a>::<wbr><a href="index.html">dispatchables</a></div><h1>Function <span class="fn">upload_program</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/pallet_gear/lib.rs.html#151">Source</a> </span></div><pre class="rust item-decl"><code>pub fn upload_program&lt;T: <a class="trait" href="../trait.Config.html" title="trait pallet_gear::pallet::Config">Config</a>&gt;(
    code: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>&gt;,
    salt: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>&gt;,
    init_payload: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>&gt;,
    gas_limit: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>,
    value: &lt;&lt;T as Config&gt;::Currency as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance,
    keep_alive: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>,
)</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Creates program initialization request (message), that is scheduled to be run in the same block.</p>
<p>There are no guarantees that initialization message will be run in the same block due to block
gas limit restrictions. For example, when it will be the message’s turn, required gas limit for it
could be more than remaining block gas limit. Therefore, the message processing will be postponed
until the next block.</p>
<p><code>ActorId</code> is computed as Blake256 hash of concatenated bytes of <code>code</code> + <code>salt</code>. (todo #512 <code>code_hash</code> + <code>salt</code>)
Such <code>ActorId</code> must not exist in the Program Storage at the time of this call.</p>
<p>There is the same guarantee here as in <code>upload_code</code>. That is, future program’s
<code>code</code> and metadata are stored before message was added to the queue and processed.</p>
<p>The origin must be Signed and the sender must have sufficient funds to pay
for <code>gas</code> and <code>value</code> (in case the latter is being transferred).</p>
<p>Gear runtime guarantees that an active program always has an account to store value.
If the underlying account management platform (e.g. Substrate’s System pallet) requires
an existential deposit to keep an account alive, the related overhead is considered an
extra cost related with a program instantiation and is charged to the program’s creator
and is released back to the creator when the program is removed.
In context of the above, the <code>value</code> parameter represents the so-called <code>reducible</code> balance
a program should have at its disposal upon instantiation. It is not used to offset the
existential deposit required for an account creation.</p>
<p>Parameters:</p>
<ul>
<li><code>code</code>: wasm code of a program as a byte vector.</li>
<li><code>salt</code>: randomness term (a seed) to allow programs with identical code
to be created independently.</li>
<li><code>init_payload</code>: encoded parameters of the wasm module <code>init</code> function.</li>
<li><code>gas_limit</code>: maximum amount of gas the program can spend before it is halted.</li>
<li><code>value</code>: balance to be transferred to the program once it’s been created.</li>
</ul>
<p>Emits the following events:</p>
<ul>
<li><code>InitMessageEnqueued(MessageInfo)</code> when init message is placed in the queue.</li>
</ul>
<h2 id="note"><a class="doc-anchor" href="#note">§</a>Note</h2>
<p>Faulty (uninitialized) programs still have a valid addresses (program ids) that can deterministically be derived on the
caller’s side upfront. It means that if messages are sent to such an address, they might still linger in the queue.</p>
<p>In order to mitigate the risk of users’ funds being sent to an address,
where a valid program should have resided, while it’s not,
such “failed-to-initialize” programs are not silently deleted from the
program storage but rather marked as “ghost” programs.
Ghost program can be removed by their original author via an explicit call.
The funds stored by a ghost program will be release to the author once the program
has been removed.</p>
<h2 id="warning-doc-only"><a class="doc-anchor" href="#warning-doc-only">§</a>Warning: Doc-Only</h2>
<p>This function is an automatically generated, and is doc-only, uncallable
stub. See the real version in
<a href="../struct.Pallet.html#method.upload_program" title="associated function pallet_gear::pallet::Pallet::upload_program"><code>Pallet::upload_program</code></a>.</p>
</div></details></section></div></main></body></html>